DOCKER_USERNAME ?= iascfrba
APPLICATION_NAME ?= practica-ruby-ab
GIT_HASH ?= $(shell git log --format="%h" -n 1)
BUILD_ARGS_TAG ?= ${GIT_HASH}
BUILD_ARGS_RELEASE_TAG ?= latest
BUILD_ARGS_DOCKERFILE ?= Dockerfile
 
build:
	docker build --tag ${DOCKER_USERNAME}/${APPLICATION_NAME}:${BUILD_ARGS_TAG} -f ${BUILD_ARGS_DOCKERFILE} .

release:
	docker build --tag ${DOCKER_USERNAME}/${APPLICATION_NAME}:${BUILD_ARGS_TAG} -f ${BUILD_ARGS_DOCKERFILE} .
	docker tag  ${DOCKER_USERNAME}/${APPLICATION_NAME}:${BUILD_ARGS_TAG} ${DOCKER_USERNAME}/${APPLICATION_NAME}:latest
	docker push ${DOCKER_USERNAME}/${APPLICATION_NAME}:${BUILD_ARGS_RELEASE_TAG}
